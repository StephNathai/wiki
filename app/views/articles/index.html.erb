<p id="notice"><%= notice %></p>
<% if current_user %>
  <div class="name"> You are logged in as: <%= link_to(current_user.first_name, user_path(current_user)) %></div>
  <div class="logout"> <%= link_to 'Log Out', '/logout' %> </div>
  <div class="home"><%= link_to 'Home', '/' %> </div>
  <div class="directory"><%= link_to 'Directory', '/users' %> </div>

  <h1 class="heading">Welcome to LIC Wiki!</h1>

  <table>
    <thead>
      <tr>
        <th>Title</th>
        <th>Content</th>
        <th>Tag</th>
        <th>Published By</th>
        <th>Last Updated</th>
        <th colspan="3"></th>
      </tr>
    </thead>

  <tbody>

    <% @articles.each do |article| %>
    <% tag_title = "#{article.tag.title}" %>
      <tr>
        <td><%= article.title %></td>
        <td><%= markdown(article.content) %></td>
        <td><%= link_to tag_title, article.tag %>
        <td>Published <%= time_ago_in_words article.created_at %> ago by <%= article.user.first_name %></td>
        <td>Updated <%= time_ago_in_words article.updated_at %> ago by <%= article.user.first_name %></td>
        <% if article.user == current_user %>
        <td><%= link_to 'Show', article %></td>
        <td><%= link_to 'Edit', edit_article_path(article) %></td>
        <td><%= link_to 'Destroy', article, method: :delete, data: { confirm: 'Are you sure?' } %></td>
        <% end %>
      </tr>
    <% end %>
    <%= link_to 'New Article', new_article_path %>
  </tbody>
</table>


<% else %>
<div class="login">
  <div class="new_user">
    <%= link_to 'New User', new_user_path %>
  </div>
  <form action="/login" method="post" class="login">
    <input type="hidden" name="authenticity_token" value="<%= form_authenticity_token %>" />
    <div>
      <lable for="email">Email:</label>
      <input name="email" type="text" />
    </div>
    <div>
      <lable for="password">Password:</label>
      <input name="password" type="password" />
    </div>
    <div>
      <input type="submit" />
    </div>
  </form>
</div>
<div class="heading">
  <h1>Welcome to LIC Wiki!</h1>
</div>
<div class="table">
  <table class="table">
    <thead>
      <tr>
        <th>Title</th>
        <th>Content</th>
        <th>Category</th>
        <th>Published By</th>
        <th>Last Edited</th>
        <th colspan="3"></th>
      </tr>
    </thead>
    <tbody>
      <% @articles.each do |article| %>
        <% tag_title = "#{article.tag.title}" %>
        <tr>
            <% full_name = "#{article.user.first_name}" + " " + "#{article.user.last_name}" %>
          <td><%= article.title %></td>
          <td><%= markdown("#{article.content}") %></td>
          <td><%= link_to tag_title, article.tag %>
          <td><%= full_name %></td>
          <td>Updated <%= time_ago_in_words article.updated_at %></td>
          <td><%= link_to 'Show', article %></td>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>
<% end %>
